<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SpaceDino Stars</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/phaser@3.70.0/dist/phaser.min.js"></script>

  <style>
    html, body { margin: 0; padding: 0; overflow: hidden; }
    canvas { display: block; }
  </style>
</head>
<body>

<script>
Telegram.WebApp.ready();
Telegram.WebApp.expand();

const config = {
  type: Phaser.AUTO,
  width: window.innerWidth,
  height: window.innerHeight,
  backgroundColor: '#000000',
  scene: { preload }
};

let coins = 0;
let coinsText;

new Phaser.Game(config);

function preload() {
  this.load.image('bg', 'https://labs.phaser.io/assets/skies/space3.png');
  this.load.image('dino', 'https://raw.githubusercontent.com/LevaMakeGames/space-dino/main/dino2.jpeg');
  this.load.image('coin', 'https://raw.githubusercontent.com/LevaMakeGames/space-dino/main/assets/coin.png');

  this.load.once('complete', create, this);
  this.load.start();
}

function create() {
  const width = this.scale.width;
  const height = this.scale.height;
  const centerX = width / 2;
  const centerY = height / 2;

  this.add.image(centerX, centerY, 'bg').setDisplaySize(width, height);
  this.add.image(centerX, centerY, 'dino').setScale(2);

  const clickZone = this.add.zone(0, 0, width, height).setOrigin(0).setInteractive();

  clickZone.on('pointerdown', (pointer) => {
    coins++;
    coinsText.setText(`Coins: ${coins}`);

    const coin = this.add.image(pointer.x, pointer.y, 'coin').setScale(0.3);
    this.tweens.add({
      targets: coin,
      y: coin.y - 100,
      alpha: 0,
      duration: 600,
      ease: 'Cubic.easeOut',
      onComplete: () => coin.destroy()
    });
  });

  coinsText = this.add.text(20, 20, 'Coins: 0', {
    font: '24px Arial',
    fill: '#ffffff'
  });

  // Кнопка покупки за Stars
  const buyBtn = this.add.text(20, 80, 'Buy Booster (Stars)', {
    font: '20px Arial',
    fill: '#fff',
    backgroundColor: '#44c',
    padding: 10
  }).setInteractive();

  buyBtn.on('pointerdown', () => {
    Telegram.WebApp.openInvoice({
      provider_token: "", // ← Пусто!
      title: "Booster Pack",
      description: "Get 3 random dinos",
      payload: "booster1",
      currency: "XTR", // ← ВАЖНО: Stars
      prices: [{ label: "Booster", amount: 4900 }] // 49 Stars
    });
  });
}
</script>

</body>
</html>
